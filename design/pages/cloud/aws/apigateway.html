<div class="custom-container">
<h3 class="toc-title">Table of Contents</h3>
<ol class="toc-list">
<li><a href="#ag-overview">Amazon API Gateway Overview</a></li>
<li><a href="#ag-features">Key Features & Benefits</a></li>
<li><a href="#ag-endpoints">API Endpoint Types</a></li>
<li><a href="#ag-api-types">API Types (REST vs. WebSocket)</a></li>
<li><a href="#ag-deployments-stages">Deployments & Stages</a></li>
<li><a href="#ag-mapping-templates">Mapping Templates</a></li>
<li><a href="#ag-caching">Caching</a></li>
<li><a href="#ag-throttling">API Throttling</a></li>
<li><a href="#ag-integrations">Integrations & Method Requests/Responses</a></li>
<li><a href="#ag-integration-types">Integration Types (Crucial!)</a></li>
<li><a href="#ag-usage-plans-api-keys">Usage Plans & API Keys</a></li>
<li><a href="#ag-cors">Same Origin Policy & CORS</a></li>
<li><a href="#ag-auth">Identity and Access Management (Authorization)</a></li>
<li><a href="#ag-logging-monitoring">Logging and Monitoring</a></li>
<li><a href="#ag-openapi">Open API / Swagger</a></li>
<li><a href="#ag-charges">Charges</a></li>
<li><a href="#ag-exam-tips">Important Exam Tips & Tricks</a></li>
</ol>
</div>
<hr>

<h3 id="ag-overview">Amazon API Gateway Overview</h3>
<ul>
<li><strong>Definition:</strong> Fully managed service for developers to publish, maintain, monitor, and secure APIs at any scale.</li>
<li>Supports creating, deploying, and managing RESTful APIs (HTTP APIs or REST APIs) and WebSocket APIs.</li>
<li>Exposes backend HTTP endpoints, AWS Lambda functions, or other AWS services.</li>
<li>Together with Lambda, forms the app-facing part of the AWS serverless infrastructure.</li>
<li>Handles concurrent API calls (traffic management, authorization, monitoring, version management).</li>
<li>REST APIs use JSON.</li>
<li>Exposes HTTPS endpoints ONLY; does not support unencrypted endpoints. (<strong>Exam Tip!</strong>)</li>
<li>Can present a certificate to be authenticated by the backend.</li>
<li>Uses CloudFront as the public endpoint for Edge-optimized APIs.</li>
<li>Supports custom domains and Server Name Indication (SNI).</li>
<li>Supports API keys and Usage Plans for user identification, throttling, and quota management.</li>
<li>Permissions granted using IAM roles/policies, API Gateway custom authorizers, or Cognito User Pools.</li>
</ul>
<hr>

<h3 id="ag-features">Key Features & Benefits</h3>
<ul>
<li>Support for RESTful APIs (HTTP APIs, REST APIs) and WebSocket APIs.</li>
<li>Private Integrations: Route requests to private resources in your VPC (e.g., ALBs, NLBs, IP-based services in Cloud Map).</li>
<li>Metering: Define usage plans to meter and restrict third-party developer access (throttling, quotas).</li>
<li>Security: Multiple tools to authorize access (IAM, Lambda Authorizers, Cognito User Pools).</li>
<li>Resiliency: Traffic management with throttling to withstand spikes.</li>
<li>Operations Monitoring: Metrics dashboard (CloudWatch) for API calls.</li>
<li>Lifecycle Management: Operate multiple API versions and stages simultaneously.</li>
<li>AWS Authorization: Supports Signature Version 4 for REST/WebSocket APIs, IAM access policies, and authorization with bearer tokens (JWT, SAML) using Lambda functions.</li>
</ul>
<hr>

<h3 id="ag-endpoints">API Endpoint Types</h3>
<ul>
<li>Hostname format: {api-id}.execute-api.{region}.amazonaws.com.</li>
<li>Types: Edge-optimized, Regional, or Private.</li>
<li><strong>Edge-Optimized Endpoint:</strong>
<ul>
<li>Default for API Gateway REST APIs. (<strong>Exam Tip!</strong>)</li>
<li>Best for geographically distributed clients.</li>
<li>API requests routed to the nearest CloudFront Point of Presence (POP).</li>
<li>Capitalizes HTTP headers (e.g., Cookie).</li>
<li>Custom domain applies across all regions.</li>
</ul>
</li>
<li><strong>Regional Endpoint:</strong>
<ul>
<li>Intended for clients in the same region.</li>
<li>Reduces connection overhead for EC2 instances in the same region or small number of high-demand clients.</li>
<li>Custom domain specific to the region where API is deployed. Can have same custom domain in multiple regions (use Route 53 for latency-based routing).</li>
<li>Passes all header names through as-is.</li>
</ul>
</li>
<li><strong>Private Endpoint:</strong>
<ul>
<li>Accessed only from your Amazon VPC using an interface VPC endpoint (an ENI created in your VPC). (<strong>Exam Tip!</strong>)</li>
<li>Passes all header names through as-is.</li>
</ul>
</li>
</ul>
<hr>

<h3 id="ag-api-types">API Types (REST vs. WebSocket)</h3>
<ul>
<li><strong>API Gateway REST API:</strong>
<ul>
<li>Collection of HTTP resources and methods.</li>
<li>Integrated with backend HTTP endpoints, Lambda functions, or other AWS services.</li>
<li>Deployed in one or more stages. Resources organized in a tree, methods use HTTP verbs (GET, PUT, POST, DELETE, ANY).</li>
</ul>
</li>
<li><strong>API Gateway WebSocket API:</strong>
<ul>
<li>Collection of WebSocket routes and route keys.</li>
<li>Integrated with backend HTTP endpoints, Lambda functions, or other AWS services.</li>
<li>Deployed in one or more stages. Invoked through frontend WebSocket connections.</li>
</ul>
</li>
</ul>
<hr>

<h3 id="ag-deployments-stages">Deployments & Stages</h3>
<ul>
<li><strong>Deployments:</strong> A snapshot of the API's resources and methods. Must be created and associated with a stage for access.</li>
<li><strong>Stages:</strong> A logical reference to a lifecycle state of your API (e.g., 'dev', 'prod', 'beta', 'v2'). Identified by API ID and stage name.</li>
<li><strong>Stage Variables:</strong>
<ul>
<li>Like environment variables for API Gateway.</li>
<li>Can be used in: Lambda function ARN, HTTP endpoint, parameter mapping templates.</li>
<li>Passed to the "context" object in Lambda functions.</li>
<li>Used with Lambda aliases for canary deployments (can choose percentage of traffic).</li>
</ul>
</li>
</ul>
<hr>

<h3 id="ag-mapping-templates">Mapping Templates</h3>
<ul>
<li>Used to modify request/response bodies and parameters.</li>
<li>Purpose: Rename parameters, modify body content, add headers, map JSON to XML (or vice versa), filter output results.</li>
<li>Uses Velocity Template Language (VTL). (<strong>Exam Tip!</strong>)</li>
<li>Can be specified in the integration request or integration response.</li>
<li>Can reference data available at runtime as context and stage variables.</li>
<li>Can be an identity transform (pass headers/body through as-is).</li>
</ul>
<hr>

<h3 id="ag-caching">Caching</h3>
<ul>
<li>You can provision an API Gateway cache (size in GB) to cache endpoint responses.</li>
<li>Benefits: Reduces calls to the backend, improves latency.</li>
<li>TTL (Time to Live): API Gateway caches responses for a specific amount of time. Default 300 seconds (min 0, max 3600).</li>
<li>Caches are defined per stage.</li>
<li>Caches can be encrypted.</li>
<li>Capacity: 0.5GB to 237GB.</li>
<li>Possible to override cache settings for specific methods.</li>
<li>Can flush the entire cache immediately.</li>
<li>Clients can invalidate the cache with the header: Cache-Control: max-age=0.</li>
</ul>
<hr>

<h3 id="ag-throttling">API Throttling</h3>
<ul>
<li>API Gateway sets limits on steady-state rate and burst of requests across all APIs in your account.</li>
<li>Account Limits (soft limits, can be increased):
<ul>
<li>Steady-state request rate: 10,000 requests per second.</li>
<li>Maximum concurrent requests: 5,000 requests.</li>
</ul>
</li>
<li>Exceeding limits results in a 429 Too Many Requests error response. Client should implement retry logic with exponential backoff.</li>
<li><strong>Types of Throttling Settings:</strong>
<ul>
<li>Server-side: Applied across all clients to prevent API/account overwhelm.</li>
<li>Per-client: Applied to clients using API keys associated with usage plans.</li>
</ul>
</li>
<li><strong>Order of Application (most specific to most general):</strong> (<strong>Exam Tip!</strong>)
<ol>
<li>Per-client per-method throttling limits (set in usage plan for an API stage).</li>
<li>Per-client throttling limits (set in a usage plan).</li>
<li>Default per-method limits and individual per-method limits (set in API stage settings).</li>
<li>Account-level throttling.</li>
</ol>
</li>
</ul>
<hr>

<h3 id="ag-integrations">Integrations & Method Requests/Responses</h3>
<ul>
<li>An API method (client-facing) is integrated with an Integration resource (backend-facing).</li>
<li>Backend endpoints are "integration endpoints".</li>
<li><strong>Integration Request:</strong> Internal interface mapping client request body/parameters to backend format.</li>
<li><strong>Integration Response:</strong> Internal interface mapping backend status codes, headers, payload to client response format.</li>
<li><strong>Method Request:</strong> Public interface defining parameters/body client must send.</li>
<li><strong>Method Response:</strong> Public interface defining status codes, headers, body models client should expect.</li>
</ul>
<hr>

<h3 id="ag-integration-types">Integration Types (Crucial!)</h3>
<ul>
<li>Choose based on backend type and desired data flow. Set via type property on the Integration resource.</li>
<li><strong>AWS Integration (AWS):</strong>
<ul>
<li>Exposes AWS service actions (e.g., direct DynamoDB API calls, S3).</li>
<li>Requires configuring both integration request and integration response (manual data mappings).</li>
</ul>
</li>
<li><strong>Lambda Proxy Integration (AWS_PROXY):</strong>
<ul>
<li>Preferred and highly recommended for integrating with Lambda functions. (<strong>Exam Tip!</strong>)</li>
<li>Streamlined setup: You DO NOT set the integration request or integration response. (<strong>Exam Tip!</strong>)</li>
<li>API Gateway passes the entire incoming request from the client (headers, path variables, query strings, body) as a single JSON event to the Lambda function.</li>
<li>Lambda function parses the input and must return a specific output format for API Gateway to respond correctly.</li>
<li>Not applicable to other AWS service actions beyond Lambda function invocation.</li>
</ul>
</li>
<li><strong>HTTP Integration (HTTP):</strong>
<ul>
<li>Exposes HTTP endpoints.</li>
<li>Requires configuring both integration request and integration response (manual data mappings).</li>
</ul>
</li>
<li><strong>HTTP Proxy Integration (HTTP_PROXY):</strong>
<ul>
<li>Allows client to access backend HTTP endpoints with a streamlined setup.</li>
<li>You DO NOT set the integration request or integration response. (<strong>Exam Tip!</strong>)</li>
<li>API Gateway passes the incoming request directly to the HTTP endpoint and the outgoing response directly back to the client.</li>
</ul>
</li>
<li><strong>Mock Integration (MOCK):</strong>
<ul>
<li>API Gateway returns a response without sending the request to the backend.</li>
<li>Useful for: API testing, collaborative development (simulating other teams' components), returning CORS-related headers.</li>
<li>The API Gateway console integrates the OPTIONS method to support CORS with a mock integration.</li>
<li>Gateway responses are also examples of mock integrations.</li>
</ul>
</li>
</ul>
<hr>

<h3 id="ag-usage-plans-api-keys">Usage Plans & API Keys</h3>
<ul>
<li><strong>Usage Plan:</strong> Specifies who can access deployed API stages/methods, and how much/how fast (throttling and quota limits). Enforced on individual client API keys.</li>
<li><strong>API Keys:</strong> Alphanumeric string values distributed to app developers to grant access. Can be used with usage plans or Lambda authorizers. Generated by API Gateway or imported.</li>
</ul>
<hr>

<h3 id="ag-cors">Same Origin Policy & CORS</h3>
<ul>
<li><strong>Same Origin Policy:</strong> A web browser security mechanism preventing scripts on one web page from accessing data in a second web page unless they have the same origin (domain, protocol, port). Enforced by web browsers.</li>
<li><strong>CORS (Cross-Origin Resource Sharing):</strong> A mechanism that allows restricted resources on a web page to be requested from another domain outside the domain from which the first resource was served.
<ul>
<li>Can enable CORS on API Gateway if using JavaScript/AJAX.</li>
<li>Allows sharing of resources between different domains.</li>
<li>If CORS is not enabled, cross-origin requests will be blocked by the browser.</li>
<li>Enable CORS on the API resources using the selected methods under API Gateway.</li>
<li>API Gateway console automatically sets up the OPTIONS method with a mock integration for CORS preflight requests.</li>
</ul>
</li>
</ul>
<hr>

<h3 id="ag-auth">Identity and Access Management (Authorization)</h3>
<ul>
<li>Several mechanisms for controlling and managing access to an API:</li>
<li><strong>Resource-based Policies:</strong>
<ul>
<li>JSON policy documents attached directly to the API (resource).</li>
<li>Control invocation by specified principals (IAM user/role), source IP ranges, VPCs, or VPC endpoints.</li>
<li>Apply to all API endpoint types (private, edge-optimized, Regional).</li>
</ul>
</li>
<li><strong>Standard IAM Roles and Policies (Identity-based Policies):</strong>
<ul>
<li>Create IAM policies and attach to users/roles.</li>
<li>API Gateway verifies IAM permissions (leverages SigV4).</li>
<li>Handles authentication and authorization. Great for users/roles within your AWS account.</li>
</ul>
</li>
<li><strong>Lambda Authorizers (Custom Authorizers):</strong>
<ul>
<li>Use an AWS Lambda function to validate a token (e.g., OAuth, SAML, custom tokens) in the request header. (<strong>Exam Tip!</strong>)</li>
<li>Option to cache the result of the authentication for performance.</li>
<li>The Lambda function must return an IAM policy for the user, which API Gateway then uses for authorization.</li>
<li>You pay per Lambda invocation. Good for using OAuth, SAML, or 3rd party authentication.</li>
</ul>
</li>
<li><strong>Amazon Cognito User Pools:</strong>
<ul>
<li>Integrate directly with a Cognito User Pool for authentication.</li>
<li>Users sign in via Cognito, which issues JWTs. API Gateway validates these JWTs.</li>
<li>Provides sign-up/sign-in services, customizable UI, social sign-in, user directory management.</li>
</ul>
</li>
</ul>
<hr>

<h3 id="ag-logging-monitoring">Logging and Monitoring</h3>
<ul>
<li>API Gateway logs backend performance metrics (API calls, latency, error rates) to CloudWatch (near real-time).</li>
<li>Monitor through the API Gateway dashboard.</li>
<li>Meters utilization by third-party developers.</li>
<li>Integrated with AWS CloudTrail for a full auditable history of changes to your REST APIs (management events: create, modify, delete, deploy APIs).</li>
<li><strong>Key Metrics to Monitor:</strong>
<ul>
<li>IntegrationLatency: Measures responsiveness of the backend.</li>
<li>Latency: Measures overall responsiveness of API calls.</li>
<li>CacheHitCount, CacheMissCount: Optimize cache capacities.</li>
</ul>
</li>
</ul>
<hr>

<h3 id="ag-openapi">Open API / Swagger</h3>
<ul>
<li>Can import existing Swagger / Open API 3.0 definitions (YAML or JSON) to API Gateway.</li>
<li>Common way of defining REST APIs using API definition as code.</li>
<li>Can also export current APIs as Swagger / Open API 3.0 definition.</li>
<li>Use the Import API feature (POST for new API, PUT for update/merge).</li>
</ul>
<hr>

<h3 id="ag-charges">Charges</h3>
<ul>
<li>Pay only when your APIs are in use. No minimum fees or upfront commitments.</li>
<li>Pay only for API calls received and the amount of data transferred out.</li>
<li>No data transfer out charges for Private APIs (but AWS PrivateLink charges apply).</li>
<li>Optional data caching is charged at an hourly rate based on cache size.</li>
<li>Free tier includes one million API calls per month for up to 12 months.</li>
</ul>
<hr>

<h3 id="ag-exam-tips">Important Exam Tips & Tricks</h3>
<ul>
<li>HTTPS Only: API Gateway always exposes HTTPS endpoints.</li>
<li>Endpoint Types: Understand the use cases for Edge-optimized (global clients, default), Regional (same-region clients), and Private (VPC only via VPC endpoint).</li>
<li>Lambda Proxy Integration (AWS_PROXY): This is a huge time-saver for Lambda integrations. Remember it passes the full request to Lambda and expects a specific response format, without requiring manual mapping templates. (<strong>Very Common Exam Question!</strong>)</li>
<li>HTTP Proxy Integration (HTTP_PROXY): Similar to Lambda Proxy, it's a pass-through for HTTP backends, no manual mapping templates needed.</li>
<li>Mapping Templates (VTL): Crucial for transforming requests/responses when not using proxy integrations.</li>
<li>Caching: Understand its benefits (latency, backend load) and configurable parameters (TTL, per stage, flushable).</li>
<li>Throttling: Know the account-level limits and the order in which throttling rules are applied. Be prepared for 429 errors and client-side retry logic.</li>
<li>Authorization Options: Be able to differentiate between IAM (for AWS users/roles), Lambda Authorizers (for custom auth schemes/3rd parties), and Cognito User Pools (for web/mobile app users).</li>
<li>CORS: Know why it's needed (Same Origin Policy) and how API Gateway helps enable it (especially with OPTIONS method).</li>
<li>CloudWatch vs. CloudTrail: CloudWatch for performance metrics and operational health. CloudTrail for auditing API management calls.</li>
<li>Stage Variables: Useful for managing environment-specific configurations (e.g., different backend endpoints for dev/prod).</li>
<li>Mock Integration: Use for testing and simulating backend responses without actual backend calls.</li>
</ul>
<hr>